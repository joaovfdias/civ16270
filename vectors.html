<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Interactive Vector Addition</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <style>
    body { margin: 0; font-family: sans-serif; }
    #controls { padding: 10px; background: #f2f2f2; }
    button { margin-right: 10px; padding: 6px 12px; }
    canvas { display: block; }
  </style>
</head>
<body>
  <div id="controls">
    <button onclick="showAComp = !showAComp">Toggle A Components</button>
    <button onclick="showBComp = !showBComp">Toggle B Components</button>
    <button onclick="showSumComp = !showSumComp">Toggle Sum Components</button>
  </div>

  <script>
    let origin;
    let vecA, vecB;
    let draggingA = false, draggingB = false;
    let handleRadius = 10;

    let showAComp = false;
    let showBComp = false;
    let showSumComp = false;

    function setup() {
      createCanvas(800, 600);
      origin = createVector(width/2, height/2);
      vecA = createVector(100, -80);
      vecB = createVector(80, 120);
    }

    function draw() {
      background(255);
      drawAxes();

      let tipA = p5.Vector.add(origin, vecA);
      let tipB = p5.Vector.add(origin, vecB);
      let vecSum = p5.Vector.add(vecA, vecB);
      let tipSum = p5.Vector.add(origin, vecSum);

      drawArrow(origin, tipA, color(0, 102, 204), 'A');
      drawArrow(origin, tipB, color(204, 102, 0), 'B');
      drawArrow(origin, tipSum, color(255, 0, 0), 'A + B');

      fill(0, 102, 204); ellipse(tipA.x, tipA.y, handleRadius*2);
      fill(204, 102, 0); ellipse(tipB.x, tipB.y, handleRadius*2);

      if (showAComp) drawComponents(vecA, color(0, 102, 204));
      if (showBComp) drawComponents(vecB, color(204, 102, 0));
      if (showSumComp) drawComponents(vecSum, color(255, 0, 0));
    }

    function drawAxes() {
      stroke(220);
      for (let x = 0; x < width; x += 40) line(x, 0, x, height);
      for (let y = 0; y < height; y += 40) line(0, y, width, y);
      stroke(0);
      line(0, height/2, width, height/2);
      line(width/2, 0, width/2, height);
    }

    function drawArrow(base, vecEnd, col, label) {
      stroke(col);
      fill(col);
      strokeWeight(2);
      line(base.x, base.y, vecEnd.x, vecEnd.y);
      let angle = atan2(vecEnd.y - base.y, vecEnd.x - base.x);
      push();
      translate(vecEnd.x, vecEnd.y);
      rotate(angle);
      triangle(0, 0, -10, 5, -10, -5);
      pop();
      noStroke();
      textSize(16);
      text(label, vecEnd.x + 5, vecEnd.y - 5);
    }

    function drawComponents(vec, col) {
      const xComp = createVector(vec.x, 0);
      const yComp = createVector(0, vec.y);
      const endX = p5.Vector.add(origin, xComp);
      const endY = p5.Vector.add(endX, yComp);

      stroke(col);
      strokeWeight(1);
      drawingContext.setLineDash([5, 5]);
      line(origin.x, origin.y, endX.x, endX.y); // x component
      line(endX.x, endX.y, endY.x, endY.y);     // y component
      drawingContext.setLineDash([]);
    }

    function mousePressed() {
      let tipA = p5.Vector.add(origin, vecA);
      let tipB = p5.Vector.add(origin, vecB);
      if (dist(mouseX, mouseY, tipA.x, tipA.y) < handleRadius) draggingA = true;
      else if (dist(mouseX, mouseY, tipB.x, tipB.y) < handleRadius) draggingB = true;
    }

    function mouseDragged() {
      if (draggingA) vecA = createVector(mouseX - origin.x, mouseY - origin.y);
      else if (draggingB) vecB = createVector(mouseX - origin.x, mouseY - origin.y);
    }

    function mouseReleased() {
      draggingA = false;
      draggingB = false;
    }
  </script>
</body>
</html>
